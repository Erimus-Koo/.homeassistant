(function(){"use strict";function a(){const b=H(["\n          <div class=\"info__item\">\n            <span class=\"info__item__type\">","</span>\n            <span class=\"info__item__value\">\n              "," ","\n            </span>\n            <span class=\"info__item__time\">\n              ","\n            </span>\n          </div>\n        "]);return a=function(){return b},b}function b(){const a=H(["\n      <div class=\"info flex\">\n        ","\n      </div>\n    "]);return b=function(){return a},a}function c(){const a=H(["\n      <div class=\"graph__labels --secondary flex\">\n        <span class=\"label--max\">","</span>\n        <span class=\"label--min\">","</span>\n      </div>\n    "]);return c=function(){return a},a}function d(){const a=H(["\n      <div class=\"graph__labels --primary flex\">\n        <span class=\"label--max\">","</span>\n        <span class=\"label--min\">","</span>\n      </div>\n    "]);return d=function(){return a},a}function e(){const a=H(["\n      <svg width='100%' height="," viewBox='0 0 500 ","'\n        @click=",">\n        <g>\n          <defs>\n            ","\n          </defs>\n          ","\n          ","\n          ","\n          ","\n          ","\n        </g>\n        ","\n      </svg>"]);return e=function(){return a},a}function f(){const a=H(["<g class='bars' ?anim=",">","</g>"]);return f=function(){return a},a}function g(){const a=H(["\n        <rect class='bar' x="," y=","\n          height="," width="," fill=","\n          @mouseover=","\n          @mouseout=",">\n          ","\n        </rect>"]);return g=function(){return a},a}function h(){const a=H(["\n          <animate attributeName='y' from="," to="," dur='1s' fill='remove'\n            calcMode='spline' keyTimes='0; 1' keySplines='0.215 0.61 0.355 1'>\n          </animate>"]);return h=function(){return a},a}function j(){const a=H(["\n      <rect class='fill--rect'\n        ?inactive=","\n        id=","\n        fill="," height=\"100%\" width=\"100%\"\n        mask=","\n      />"]);return j=function(){return a},a}function k(){const a=H(["\n      <rect class='line--rect'\n        ?inactive=","\n        id=","\n        fill="," height=\"100%\" width=\"100%\"\n        mask=","\n      />"]);return k=function(){return a},a}function l(){const a=H(["",""]);return l=function(){return a},a}function m(){const a=H(["\n            <stop stop-color="," offset="," />\n          "]);return m=function(){return a},a}function n(){const a=H(["\n        <linearGradient id="," gradientTransform=\"rotate(90)\">\n          ","\n        </linearGradient>"]);return n=function(){return a},a}function o(){const a=H(["\n      <g class='line--points'\n        ?tooltip=","\n        ?inactive=","\n        ?init=","\n        anim=","\n        style=\"animation-delay: ","\"\n        fill=","\n        stroke=","\n        stroke-width=",">\n        ","\n      </g>"]);return o=function(){return a},a}function p(){const a=H(["\n      <circle\n        class='line--point'\n        ?inactive=","\n        style=","\n        stroke=","\n        fill=","\n        cx="," cy="," r=","\n        @mouseover=","\n        @mouseout=","\n      />\n    "]);return p=function(){return a},a}function q(){const a=H(["\n      <mask id=",">\n        ","\n      </mask>\n    "]);return q=function(){return a},a}function r(){const a=H(["\n      <path\n        class='line'\n        .id=","\n        anim="," ?init=","\n        style=\"animation-delay: ","\"\n        fill='none'\n        stroke-dasharray="," stroke-dashoffset=","\n        stroke=","\n        stroke-width=","\n        d=","\n      />"]);return r=function(){return a},a}function s(){const a=H(["\n      <defs>\n        <linearGradient id="," x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n          <stop stop-color='white' offset='0%' stop-opacity='1'/>\n          <stop stop-color='white' offset='100%' stop-opacity='.15'/>\n        </linearGradient>\n        <mask id=",">\n          <rect width=\"100%\" height=\"100%\" fill="," />\n        </mask>\n      </defs>\n      <mask id=",">\n        <path class='fill'\n          type=","\n          .id="," anim="," ?init=","\n          style=\"animation-delay: ","\"\n          fill='white'\n          mask=","\n          d=","\n        />\n      </mask>"]);return s=function(){return a},a}function t(){const a=H(["\n      <svg width='10' height='10'>\n        <rect width='10' height='10' fill="," />\n      </svg>\n    "]);return t=function(){return a},a}function u(){const a=H(["\n          <div class=\"graph__legend__item\"\n            @click=","\n            @mouseover=","\n            @mouseout=",">\n            ","\n            <span class=\"ellipsis\">","</span>\n          </div>\n        "]);return u=function(){return a},a}function v(){const a=H(["\n      <div class=\"graph__legend\">\n        ","\n      </div>\n    "]);return v=function(){return a},a}function w(){const a=H(["\n      <div class=\"graph\">\n        <div class=\"graph__container\">\n          ","\n          ","\n          <div class=\"graph__container__svg\">\n            ","\n          </div>\n        </div>\n        ","\n      </div>"]);return w=function(){return a},a}function x(){const a=H(["\n          <span>","</span> -\n          <span>","</span>\n        "]);return x=function(){return a},a}function y(){const a=H(["\n          <span>","</span>\n        "]);return y=function(){return a},a}function z(){const a=H(["\n      <div class=\"state__time\">\n        ","\n      </div>\n    "]);return z=function(){return a},a}function A(){const a=H(["\n        <div\n          class=\"state state--small\"\n          @click=","\n          style=",">\n          ","\n          <span class=\"state__value ellipsis\">\n            ","\n          </span>\n          <span class=\"state__uom ellipsis\">\n            ","\n          </span>\n        </div>\n      "]);return A=function(){return a},a}function B(){const a=H(["\n        <div class=\"states flex\" loc=",">\n          <div class=\"state\">\n            <span class=\"state__value ellipsis\" style=",">\n              ","\n            </span>\n            <span class=\"state__uom ellipsis\" style=",">\n              ","\n            </span>\n            ","\n          </div>\n          <div class=\"states--secondary\">","</div>\n          ","\n        </div>\n      "]);return B=function(){return a},a}function C(){const a=H(["\n      <div class=\"name flex\">\n        <span class=\"ellipsis\" style=",">","</span>\n      </div>\n    "]);return C=function(){return a},a}function D(){const a=H(["\n      <div class=\"icon\" loc=","\n        style=",">\n        <ha-icon .icon=","></ha-icon>\n      </div>\n    "]);return D=function(){return a},a}function E(){const a=H(["\n          <div class=\"header flex\" loc="," style=\"font-size: ","px;\">\n            "," ","\n          </div>\n        "]);return E=function(){return a},a}function F(){const a=H(["\n      <ha-card\n        class=\"flex\"\n        ?group=","\n        ?fill=","\n        ?points=","\n        ?labels=","\n        ?labels-secondary=","\n        ?gradient=","\n        ?hover=","\n        style=\"font-size: ","px;\"\n        @click=","\n      >\n        "," "," "," ","\n      </ha-card>\n    "]);return F=function(){return a},a}function G(){const a=H(["\n  :host {\n    display: flex;\n    flex-direction: column;\n  }\n  ha-card {\n    flex-direction: column;\n    flex: 1;\n    padding: 16px 0;\n    position: relative;\n    overflow: hidden;\n  }\n  ha-card > div {\n    padding: 0px 16px 16px 16px;\n  }\n  ha-card > div:last-child {\n    padding-bottom: 0;\n  }\n  ha-card[points] .line--points,\n  ha-card[labels] .graph__labels.--primary {\n    opacity: 0;\n    transition: opacity .25s;\n    animation: none;\n  }\n  ha-card[labels-secondary] .graph__labels.--secondary {\n    opacity: 0;\n    transition: opacity .25s;\n    animation: none;\n  }\n  ha-card[points]:hover .line--points,\n  ha-card:hover .graph__labels.--primary,\n  ha-card:hover .graph__labels.--secondary {\n      opacity: 1;\n  }\n  ha-card[fill] {\n    padding-bottom: 0;\n  }\n  ha-card[fill] .graph {\n    padding: 0;\n    order: 10;\n  }\n  ha-card[fill] path {\n    stroke-linecap: initial;\n    stroke-linejoin: initial;\n  }\n  ha-card[fill] .graph__legend {\n    order: -1;\n    padding: 0 16px 8px 16px;\n  }\n  ha-card[fill] .info {\n    padding-bottom: 16px;\n  }\n  ha-card[group] {\n    box-shadow: none;\n    padding: 0;\n  }\n  ha-card[group] > div {\n    padding-left: 0;\n    padding-right: 0;\n  }\n  ha-card[group] .graph__legend {\n    padding-left: 0;\n    padding-right: 0;\n  }\n  ha-card[hover] {\n    cursor: pointer;\n  }\n  .flex {\n    display: flex;\n    display: -webkit-flex;\n    min-width: 0;\n  }\n  .header {\n    justify-content: space-between;\n  }\n  .header[loc=\"center\"] {\n    justify-content: space-around;\n  }\n  .header[loc=\"left\"] {\n    align-self: flex-start;\n  }\n  .header[loc=\"right\"] {\n    align-self: flex-end;\n  }\n  .name {\n    align-items: center;\n    min-width: 0;\n    letter-spacing: var(--mcg-title-letter-spacing, normal);\n  }\n  .name > span {\n    font-size: 1.2em;\n    font-weight: var(--mcg-title-font-weight, 500);\n    max-height: 1.4em;\n    min-height: 1.4em;\n    opacity: .65;\n  }\n  .icon {\n    color: var(--paper-item-icon-color, #44739e);\n    display: inline-block;\n    flex: 0 0 1.7em;\n    text-align: center;\n  }\n  .icon > ha-icon {\n    height: 1.7em;\n    width: 1.7em;\n  }\n  .icon[loc=\"left\"] {\n    order: -1;\n    margin-right: .6em;\n    margin-left: 0;\n  }\n  .icon[loc=\"state\"] {\n    align-self: center;\n  }\n  .states {\n    align-items: flex-start;\n    font-weight: 300;\n    justify-content: space-between;\n    flex-wrap: nowrap;\n  }\n  .states .icon {\n    align-self: center;\n    margin-left: 0;\n  }\n  .states[loc=\"center\"] {\n    justify-content: space-evenly;\n  }\n  .states[loc=\"right\"] > .state {\n    margin-left: auto;\n    order: 2;\n  }\n  .states[loc=\"center\"] .states--secondary,\n  .states[loc=\"right\"] .states--secondary {\n    margin-left: 0;\n  }\n  .states[loc=\"center\"] .states--secondary {\n    align-items: center;\n  }\n  .states[loc=\"right\"] .states--secondary {\n    align-items: flex-start;\n  }\n  .states[loc=\"center\"] .state__time {\n    left: 50%;\n    transform: translateX(-50%);\n  }\n  .states > .icon > ha-icon {\n    height: 2em !important;\n    width: 2em !important;\n  }\n  .states--secondary {\n    display: flex;\n    flex-flow: column;\n    flex-wrap: wrap;\n    align-items: flex-end;\n    margin-left: 1rem;\n    min-width: 0;\n    margin-left: 1.4em;\n  }\n  .states--secondary:empty {\n    display: none;\n  }\n  .state {\n    position: relative;\n    display: flex;\n    flex-wrap: nowrap;\n    max-width: 100%;\n    min-width: 0;\n  }\n  .state--small {\n    font-size: .6em;\n    margin-bottom: .6rem;\n    flex-wrap: nowrap;\n  }\n  .state--small > svg {\n    position: absolute;\n    left: -1.6em;\n    align-self: center;\n    height: 1em;\n    width: 1em;\n    border-radius: 100%;\n    margin-right: 1em;\n  }\n  .state--small:last-child {\n    margin-bottom: 0;\n  }\n  .states--secondary > :only-child {\n    font-size: 1em;\n    margin-bottom: 0;\n  }\n  .states--secondary > :only-child svg {\n    display: none;\n  }\n  .state__value {\n    display: inline-block;\n    font-size: 2.4em;\n    margin-right: .25rem;\n    line-height: 1.2em;\n  }\n  .state__uom {\n    flex: 1;\n    align-self: flex-end;\n    display: inline-block;\n    font-size: 1.4em;\n    font-weight: 400;\n    line-height: 1.6em;\n    margin-top: .1em;\n    opacity: .6;\n    vertical-align: bottom;\n  }\n  .state--small .state__uom {\n    flex: 1;\n  }\n  .state__time {\n    font-size: .95rem;\n    font-weight: 500;\n    bottom: -1.1rem;\n    left: 0;\n    opacity: .75;\n    position: absolute;\n    white-space: nowrap;\n    animation: fade .15s cubic-bezier(0.215, 0.61, 0.355, 1);\n  }\n  .states[loc=\"right\"] .state__time {\n    left: initial;\n    right: 0;\n  }\n  .graph {\n    align-self: flex-end;\n    box-sizing: border-box;\n    display: flex;\n    flex-direction: column;\n    margin-top: auto;\n    width: 100%;\n  }\n  .graph__container {\n    display: flex;\n    flex-direction: row;\n    position: relative;\n  }\n  .graph__container__svg {\n    cursor: default;\n    flex: 1;\n  }\n  svg {\n    overflow: hidden;\n    display: block;\n  }\n  path {\n    stroke-linecap: round;\n    stroke-linejoin: round;\n  }\n  .fill[anim=\"false\"] {\n    animation: reveal .25s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;\n  }\n  .fill[anim=\"false\"][type=\"fade\"] {\n    animation: reveal-2 .25s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;\n  }\n  .line--points[anim=\"false\"],\n  .line[anim=\"false\"] {\n    animation: pop .25s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;\n  }\n  .line--points[inactive],\n  .line--rect[inactive],\n  .fill--rect[inactive] {\n    opacity: 0 !important;\n    animation: none !important;\n    transition: all .15s !important;\n  }\n  .line--points[tooltip] .line--point[inactive] {\n    opacity: 0;\n  }\n  .line--point {\n    cursor: pointer;\n    fill: var(--primary-background-color, white);\n    stroke-width: inherit;\n  }\n  .line--point:hover {\n    fill: var(--mcg-hover, inherit) !important;\n  }\n  .bars {\n    animation: pop .25s cubic-bezier(0.215, 0.61, 0.355, 1);\n  }\n  .bars[anim] {\n    animation: bars .5s cubic-bezier(0.215, 0.61, 0.355, 1);\n  }\n  .bar {\n    transition: opacity .25s cubic-bezier(0.215, 0.61, 0.355, 1);\n  }\n  .bar:hover {\n    opacity: .5;\n    cursor: pointer;\n  }\n  ha-card[gradient] .line--point:hover {\n    fill: var(--primary-text-color, white);\n  }\n  path,\n  .line--points,\n  .fill {\n    opacity: 0;\n  }\n  .line--points[anim=\"true\"][init] {\n    animation: pop .5s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;\n  }\n  .fill[anim=\"true\"][init] {\n    animation: reveal .5s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;\n  }\n  .fill[anim=\"true\"][init][type=\"fade\"] {\n    animation: reveal-2 .5s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;\n  }\n  .line[anim=\"true\"][init] {\n    animation: dash 1s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;\n  }\n  .graph__labels.--secondary {\n    right: 0;\n    margin-right: 0px;\n  }\n  .graph__labels {\n    align-items: flex-start;\n    flex-direction: column;\n    font-size: calc(.15em + 8.5px);\n    font-weight: 400;\n    justify-content: space-between;\n    margin-right: 10px;\n    padding: .6em;\n    position: absolute;\n    pointer-events: none;\n    top: 0; bottom: 0;\n    opacity: .75;\n  }\n  .graph__labels > span {\n    cursor: pointer;\n    background: var(--primary-background-color, white);\n    border-radius: 1em;\n    padding: .2em .6em;\n    box-shadow: 0 1px 3px rgba(0,0,0,.12), 0 1px 2px rgba(0,0,0,.24);\n  }\n  .graph__legend {\n    display: flex;\n    flex-direction: row;\n    justify-content: space-evenly;\n    padding-top: 16px;\n    flex-wrap: wrap;\n  }\n  .graph__legend__item {\n    cursor: pointer;\n    display: flex;\n    min-width: 0;\n    margin: .4em;\n    align-items: center\n  }\n  .graph__legend__item span {\n    opacity: .75;\n    margin-left: .4em;\n  }\n  .graph__legend__item svg {\n    border-radius: 100%;\n    min-width: 10px;\n  }\n  .info {\n    justify-content: space-between;\n    align-items: middle;\n  }\n  .info__item {\n    display: flex;\n    flex-flow: column;\n    text-align: center;\n  }\n  .info__item:first-child {\n    align-items: flex-start;\n    text-align: left;\n  }\n  .info__item:last-child {\n    align-items: flex-end;\n    text-align: right;\n  }\n  .info__item__type {\n    text-transform: capitalize;\n    font-weight: 500;\n    opacity: .9;\n  }\n  .info__item__time,\n  .info__item__value {\n    opacity: .75;\n  }\n  .ellipsis {\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n  @keyframes fade {\n    0% { opacity: 0; }\n  }\n  @keyframes reveal {\n    0% { opacity: 0; }\n    100% { opacity: .15; }\n  }\n  @keyframes reveal-2 {\n    0% { opacity: 0; }\n    100% { opacity: .4; }\n  }\n  @keyframes pop {\n    0% { opacity: 0; }\n    100% { opacity: 1; }\n  }\n  @keyframes bars {\n    0% { opacity: 0; }\n    50% { opacity: 0; }\n    100% { opacity: 1; }\n  }\n  @keyframes dash {\n    0% {\n      opacity: 0;\n    }\n    25% {\n      opacity: 1;\n    }\n    100% {\n      opacity: 1;\n      stroke-dashoffset: 0;\n    }\n  }"]);return G=function(){return a},a}function H(a,b){return b||(b=a.slice(0)),Object.freeze(Object.defineProperties(a,{raw:{value:Object.freeze(b)}}))}function I(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function J(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?I(b,!0).forEach(function(c){K(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):I(b).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}function K(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function L(a){return O(a)||N(a)||M()}function M(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function N(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)}function O(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}}(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b():"function"==typeof define&&define.amd?define(b):b()})(this,function(){var va=Number.isNaN,wa=Math.abs,xa=Math.max,ya=Math.min,za=Math.ceil,Aa=Math.pow;function i(a){let b=gb.get(a.type);void 0===b&&(b={stringsArray:new WeakMap,keyString:new Map},gb.set(a.type,b));let c=b.stringsArray.get(a.strings);if(void 0!==c)return c;const d=a.strings.join(Ia);return c=b.keyString.get(d),void 0===c&&(c=new Ma(a,a.getTemplateElement()),b.keyString.set(d,c)),b.stringsArray.set(a.strings,c),c}function H(a,b){const{element:{content:d},parts:c}=a,e=document.createTreeWalker(d,lb,null,!1);let f=nb(c),g=c[f],h=-1,i=0;const j=[];for(let d=null;e.nextNode();){h++;const a=e.currentNode;for(a.previousSibling===d&&(d=null),b.has(a)&&(j.push(a),null===d&&(d=a)),null!==d&&i++;g!==void 0&&g.index===h;)g.index=null===d?g.index-i:-1,f=nb(c,f),g=c[f]}j.forEach(a=>a.parentNode.removeChild(a))}function I(a,b,c=null){const{element:{content:e},parts:d}=a;if(null===c||void 0===c)return void e.appendChild(b);const f=document.createTreeWalker(e,lb,null,!1);let g=nb(d),h=0,i=-1;for(;f.nextNode();){i++;const a=f.currentNode;for(a===c&&(h=mb(b),c.parentNode.insertBefore(b,c));-1!==g&&d[g].index===i;){if(0<h){for(;-1!==g;)d[g].index+=h,g=nb(d,g);return}g=nb(d,g)}}}function K(a,b=[]){for(let c=0,d=a.length;c<d;c++){const d=a[c];Array.isArray(d)?K(d,b):b.push(d)}return b}function M(a,b){a=a||[],b=b||{};try{return new Blob(a,b)}catch(f){if("TypeError"!==f.name)throw f;for(var c="undefined"==typeof BlobBuilder?"undefined"==typeof MSBlobBuilder?"undefined"==typeof MozBlobBuilder?WebKitBlobBuilder:MozBlobBuilder:MSBlobBuilder:BlobBuilder,d=new c,e=0;e<a.length;e+=1)d.append(a[e]);return d.getBlob(b.type)}}function N(a,b){b&&a.then(function(a){b(null,a)},function(a){b(a)})}function O(a,b,c){"function"==typeof b&&a.then(b),"function"==typeof c&&a.catch(c)}function P(a){return"string"!=typeof a&&(console.warn("".concat(a," used as a key, but it is not a string.")),a+=""),a}function Q(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}function R(a){for(var b=a.length,c=new ArrayBuffer(b),d=new Uint8Array(c),e=0;e<b;e++)d[e]=a.charCodeAt(e);return c}function S(a){return new Promise(function(b){var c=a.transaction(Pb,Ub),d=M([""]);c.objectStore(Pb).put(d,"key"),c.onabort=function(a){a.preventDefault(),a.stopPropagation(),b(!1)},c.oncomplete=function(){var a=navigator.userAgent.match(/Chrome\/(\d+)/),c=navigator.userAgent.match(/Edge\//);b(c||!a||43<=parseInt(a[1],10))}}).catch(function(){return!1})}function T(a){return"boolean"==typeof Qb?Promise.resolve(Qb):S(a).then(function(a){return Qb=a,Qb})}function U(a){var b=Rb[a.name],c={};c.promise=new Promise(function(a,b){c.resolve=a,c.reject=b}),b.deferredOperations.push(c),b.dbReady=b.dbReady?b.dbReady.then(function(){return c.promise}):c.promise}function W(a){var b=Rb[a.name],c=b.deferredOperations.pop();if(c)return c.resolve(),c.promise}function Z(a,b){var c=Rb[a.name],d=c.deferredOperations.pop();if(d)return d.reject(b),d.promise}function $(a,b){return new Promise(function(c,d){if(Rb[a.name]=Rb[a.name]||ia(),a.db)if(b)U(a),a.db.close();else return c(a.db);var e=[a.name];b&&e.push(a.version);var f=Ob.open.apply(Ob,e);b&&(f.onupgradeneeded=function(b){var c=f.result;try{c.createObjectStore(a.storeName),1>=b.oldVersion&&c.createObjectStore(Pb)}catch(c){if("ConstraintError"===c.name)console.warn("The database \""+a.name+"\" has been upgraded from version "+b.oldVersion+" to version "+b.newVersion+", but the storage \""+a.storeName+"\" already exists.");else throw c}}),f.onerror=function(a){a.preventDefault(),d(f.error)},f.onsuccess=function(){c(f.result),W(a)}})}function _(a){return $(a,!1)}function aa(a){return $(a,!0)}function ba(a,b){if(!a.db)return!0;var c=!a.db.objectStoreNames.contains(a.storeName),d=a.version<a.db.version,e=a.version>a.db.version;if(d&&(a.version!==b&&console.warn("The database \""+a.name+"\" can't be downgraded from version "+a.db.version+" to version "+a.version+"."),a.version=a.db.version),e||c){if(c){var f=a.db.version+1;f>a.version&&(a.version=f)}return!0}return!1}function ca(a){return new Promise(function(b,c){var d=new FileReader;d.onerror=c,d.onloadend=function(c){var d=btoa(c.target.result||"");b({__local_forage_encoded_blob:!0,data:d,type:a.type})},d.readAsBinaryString(a)})}function da(a){var b=R(atob(a.data));return M([b],{type:a.type})}function ea(a){return a&&a.__local_forage_encoded_blob}function fa(a){var b=this,c=b._initReady().then(function(){var a=Rb[b._dbInfo.name];if(a&&a.dbReady)return a.dbReady});return O(c,a,a),c}function ga(a){U(a);for(var b=Rb[a.name],c=b.forages,d=0;d<c.length;d++){const a=c[d];a._dbInfo.db&&(a._dbInfo.db.close(),a._dbInfo.db=null)}return a.db=null,_(a).then(b=>(a.db=b,ba(a)?aa(a):b)).then(d=>{a.db=b.db=d;for(var e=0;e<c.length;e++)c[e]._dbInfo.db=d}).catch(b=>{throw Z(a,b),b})}function ha(a,b,c,d){d===void 0&&(d=1);try{var e=a.db.transaction(a.storeName,b);c(null,e)}catch(e){if(0<d&&(!a.db||"InvalidStateError"===e.name||"NotFoundError"===e.name))return Promise.resolve().then(()=>{if(!a.db||"NotFoundError"===e.name&&!a.db.objectStoreNames.contains(a.storeName)&&a.version<=a.db.version)return a.db&&(a.version=a.db.version+1),aa(a)}).then(()=>ga(a).then(function(){ha(a,b,c,d-1)})).catch(c);c(e)}}function ia(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function ja(a){var b,c,d,e,f,g=.75*a.length,h=a.length,j=0;"="===a[a.length-1]&&(g--,"="===a[a.length-2]&&g--);var k=new ArrayBuffer(g),l=new Uint8Array(k);for(b=0;b<h;b+=4)c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a[b]),d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a[b+1]),e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a[b+2]),f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a[b+3]),l[j++]=c<<2|d>>4,l[j++]=(15&d)<<4|e>>2,l[j++]=(3&e)<<6|63&f;return k}function ka(a){var b,c=new Uint8Array(a),d="";for(b=0;b<c.length;b+=3)d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[c[b]>>2],d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(3&c[b])<<4|c[b+1]>>4],d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(15&c[b+1])<<2|c[b+2]>>6],d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[63&c[b+2]];return 2==c.length%3?d=d.substring(0,d.length-1)+"=":1==c.length%3&&(d=d.substring(0,d.length-2)+"=="),d}function la(a,b,c,d){a.executeSql("CREATE TABLE IF NOT EXISTS ".concat(b.storeName," ")+"(id INTEGER PRIMARY KEY, key unique, value)",[],c,d)}function ma(a,b,c,d,e,f){a.executeSql(c,d,e,function(a,g){g.code===g.SYNTAX_ERR?a.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[b.storeName],function(a,h){h.rows.length?f(a,g):la(a,b,function(){a.executeSql(c,d,e,f)},f)},f):f(a,g)},f)}function na(a,b,c,d){var e=this;a=P(a);var f=new Promise(function(f,g){e.ready().then(function(){void 0===b&&(b=null);var h=b,i=e._dbInfo;i.serializer.serialize(b,function(b,j){j?g(j):i.db.transaction(function(c){ma(c,i,"INSERT OR REPLACE INTO ".concat(i.storeName," ")+"(key, value) VALUES (?, ?)",[a,b],function(){f(h)},function(a,b){g(b)})},function(b){if(b.code===b.QUOTA_ERR){if(0<d)return void f(na.apply(e,[a,h,c,d-1]));g(b)}})})}).catch(g)});return N(f,c),f}function oa(a){return new Promise(function(b,c){a.transaction(function(d){d.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(c,d){for(var e=[],f=0;f<d.rows.length;f++)e.push(d.rows.item(f).name);b({db:a,storeNames:e})},function(a,b){c(b)})},function(a){c(a)})})}function pa(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(a){return!1}}function qa(a,b){var c=a.name+"/";return a.storeName!==b.storeName&&(c+=a.storeName+"/"),c}function ra(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch(a){return!0}}function sa(){return!ra()||0<localStorage.length}function ta(a,b){a[b]=function(){const c=arguments;return a.ready().then(function(){return a[b].apply(a,c)})}}function ua(){for(let a=1;a<arguments.length;a++){const b=arguments[a];if(b)for(let a in b)b.hasOwnProperty(a)&&(arguments[0][a]=dc(b[a])?b[a].slice():b[a])}return arguments[0]}const Ba=new WeakMap,Ca=a=>"function"==typeof a&&Ba.has(a),Da=window.customElements!==void 0&&window.customElements.polyfillWrapFlushCallback!==void 0,Ea=(a,b,c=null,d=null)=>{for(;b!==c;){const c=b.nextSibling;a.insertBefore(b,d),b=c}},Fa=(a,b,c=null)=>{for(;b!==c;){const c=b.nextSibling;a.removeChild(b),b=c}},Ga={},Ha={},Ia="{{lit-".concat((Math.random()+"").slice(2),"}}"),Ja="<!--".concat(Ia,"-->"),Ka=new RegExp("".concat(Ia,"|").concat(Ja)),La="$lit$";class Ma{constructor(a,b){this.parts=[],this.element=b;const c=[],d=[],e=document.createTreeWalker(b.content,133,null,!1);let f=0,g=-1,h=0;for(const{strings:i,values:{length:j}}=a;h<j;){const a=e.nextNode();if(null===a){e.currentNode=d.pop();continue}if(g++,1===a.nodeType){if(a.hasAttributes()){const b=a.attributes,{length:c}=b;let d=0;for(let a=0;a<c;a++)Na(b[a].name,La)&&d++;for(;0<d--;){const b=i[h],c=Qa.exec(b)[2],d=c.toLowerCase()+La,e=a.getAttribute(d);a.removeAttribute(d);const f=e.split(Ka);this.parts.push({type:"attribute",index:g,name:c,strings:f}),h+=f.length-1}}"TEMPLATE"===a.tagName&&(d.push(a),e.currentNode=a.content)}else if(3===a.nodeType){const b=a.data;if(0<=b.indexOf(Ia)){const d=a.parentNode,e=b.split(Ka),f=e.length-1;for(let b=0;b<f;b++){let c,f=e[b];if(""===f)c=Pa();else{const a=Qa.exec(f);null!==a&&Na(a[2],La)&&(f=f.slice(0,a.index)+a[1]+a[2].slice(0,-La.length)+a[3]),c=document.createTextNode(f)}d.insertBefore(c,a),this.parts.push({type:"node",index:++g})}""===e[f]?(d.insertBefore(Pa(),a),c.push(a)):a.data=e[f],h+=f}}else if(8===a.nodeType)if(a.data===Ia){const b=a.parentNode;(null===a.previousSibling||g===f)&&(g++,b.insertBefore(Pa(),a)),f=g,this.parts.push({type:"node",index:g}),null===a.nextSibling?a.data="":(c.push(a),g--),h++}else for(let b=-1;-1!==(b=a.data.indexOf(Ia,b+1));)this.parts.push({type:"node",index:-1}),h++}for(const d of c)d.parentNode.removeChild(d)}}const Na=(a,b)=>{const c=a.length-b.length;return 0<=c&&a.slice(c)===b},Oa=a=>-1!==a.index,Pa=()=>document.createComment(""),Qa=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;class Ra{constructor(a,b,c){this.__parts=[],this.template=a,this.processor=b,this.options=c}update(a){let b=0;for(const c of this.__parts)void 0!==c&&c.setValue(a[b]),b++;for(const b of this.__parts)void 0!==b&&b.commit()}_clone(){const a=Da?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),b=[],c=this.template.parts,d=document.createTreeWalker(a,133,null,!1);let e,f=0,g=0,h=d.nextNode();for(;f<c.length;){if(e=c[f],!Oa(e)){this.__parts.push(void 0),f++;continue}for(;g<e.index;)g++,"TEMPLATE"===h.nodeName&&(b.push(h),d.currentNode=h.content),null===(h=d.nextNode())&&(d.currentNode=b.pop(),h=d.nextNode());if("node"===e.type){const a=this.processor.handleTextExpression(this.options);a.insertAfterNode(h.previousSibling),this.__parts.push(a)}else{var i;(i=this.__parts).push.apply(i,L(this.processor.handleAttributeExpressions(h,e.name,e.strings,this.options)))}f++}return Da&&(document.adoptNode(a),customElements.upgrade(a)),a}}const Sa=" ".concat(Ia," ");class Ta{constructor(a,b,c,d){this.strings=a,this.values=b,this.type=c,this.processor=d}getHTML(){const a=this.strings.length-1;let b="",c=!1;for(let d=0;d<a;d++){const a=this.strings[d],e=a.lastIndexOf("<!--");c=(-1<e||c)&&-1===a.indexOf("-->",e+1);const f=Qa.exec(a);b+=null===f?a+(c?Sa:Ja):a.substr(0,f.index)+f[1]+f[2]+La+f[3]+Ia}return b+=this.strings[a],b}getTemplateElement(){const a=document.createElement("template");return a.innerHTML=this.getHTML(),a}}class Ua extends Ta{getHTML(){return"<svg>".concat(super.getHTML(),"</svg>")}getTemplateElement(){const a=super.getTemplateElement(),b=a.content,c=b.firstChild;return b.removeChild(c),Ea(b,c.firstChild),a}}const Va=a=>null===a||"object"!=typeof a&&"function"!=typeof a,Wa=a=>Array.isArray(a)||!!(a&&a[Symbol.iterator]);class Xa{constructor(a,b,c){this.dirty=!0,this.element=a,this.name=b,this.strings=c,this.parts=[];for(let d=0;d<c.length-1;d++)this.parts[d]=this._createPart()}_createPart(){return new Ya(this)}_getValue(){const a=this.strings,b=a.length-1;let c="";for(let d=0;d<b;d++){c+=a[d];const b=this.parts[d];if(void 0!==b){const a=b.value;if(Va(a)||!Wa(a))c+="string"==typeof a?a:a+"";else for(const b of a)c+="string"==typeof b?b:b+""}}return c+=a[b],c}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class Ya{constructor(a){this.value=void 0,this.committer=a}setValue(a){a===Ga||Va(a)&&a===this.value||(this.value=a,!Ca(a)&&(this.committer.dirty=!0))}commit(){for(;Ca(this.value);){const a=this.value;this.value=Ga,a(this)}this.value===Ga||this.committer.commit()}}class Za{constructor(a){this.value=void 0,this.__pendingValue=void 0,this.options=a}appendInto(a){this.startNode=a.appendChild(Pa()),this.endNode=a.appendChild(Pa())}insertAfterNode(a){this.startNode=a,this.endNode=a.nextSibling}appendIntoPart(a){a.__insert(this.startNode=Pa()),a.__insert(this.endNode=Pa())}insertAfterPart(a){a.__insert(this.startNode=Pa()),this.endNode=a.endNode,a.endNode=this.startNode}setValue(a){this.__pendingValue=a}commit(){for(;Ca(this.__pendingValue);){const a=this.__pendingValue;this.__pendingValue=Ga,a(this)}const a=this.__pendingValue;a===Ga||(Va(a)?a!==this.value&&this.__commitText(a):a instanceof Ta?this.__commitTemplateResult(a):a instanceof Node?this.__commitNode(a):Wa(a)?this.__commitIterable(a):a===Ha?(this.value=Ha,this.clear()):this.__commitText(a))}__insert(a){this.endNode.parentNode.insertBefore(a,this.endNode)}__commitNode(a){this.value===a||(this.clear(),this.__insert(a),this.value=a)}__commitText(a){const b=this.startNode.nextSibling;a=null==a?"":a;const c="string"==typeof a?a:a+"";b===this.endNode.previousSibling&&3===b.nodeType?b.data=c:this.__commitNode(document.createTextNode(c)),this.value=a}__commitTemplateResult(a){const b=this.options.templateFactory(a);if(this.value instanceof Ra&&this.value.template===b)this.value.update(a.values);else{const c=new Ra(b,a.processor,this.options),d=c._clone();c.update(a.values),this.__commitNode(d),this.value=c}}__commitIterable(a){Array.isArray(this.value)||(this.value=[],this.clear());const b=this.value;let c,d=0;for(const e of a)c=b[d],void 0===c&&(c=new Za(this.options),b.push(c),0===d?c.appendIntoPart(this):c.insertAfterPart(b[d-1])),c.setValue(e),c.commit(),d++;d<b.length&&(b.length=d,this.clear(c&&c.endNode))}clear(a=this.startNode){Fa(this.startNode.parentNode,a.nextSibling,this.endNode)}}class $a{constructor(a,b,c){if(this.value=void 0,this.__pendingValue=void 0,2!==c.length||""!==c[0]||""!==c[1])throw new Error("Boolean attributes can only contain a single expression");this.element=a,this.name=b,this.strings=c}setValue(a){this.__pendingValue=a}commit(){for(;Ca(this.__pendingValue);){const a=this.__pendingValue;this.__pendingValue=Ga,a(this)}if(this.__pendingValue!==Ga){const a=!!this.__pendingValue;this.value!==a&&(a?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=a),this.__pendingValue=Ga}}}class ab extends Xa{constructor(a,b,c){super(a,b,c),this.single=2===c.length&&""===c[0]&&""===c[1]}_createPart(){return new bb(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class bb extends Ya{}let cb=!1;try{const a={get capture(){return cb=!0,!1}};window.addEventListener("test",a,a),window.removeEventListener("test",a,a)}catch(a){}class db{constructor(a,b,c){this.value=void 0,this.__pendingValue=void 0,this.element=a,this.eventName=b,this.eventContext=c,this.__boundHandleEvent=a=>this.handleEvent(a)}setValue(a){this.__pendingValue=a}commit(){for(;Ca(this.__pendingValue);){const a=this.__pendingValue;this.__pendingValue=Ga,a(this)}if(this.__pendingValue===Ga)return;const a=this.__pendingValue,b=this.value,c=null==a||null!=b&&(a.capture!==b.capture||a.once!==b.once||a.passive!==b.passive);c&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),null!=a&&(null==b||c)&&(this.__options=eb(a),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=a,this.__pendingValue=Ga}handleEvent(a){"function"==typeof this.value?this.value.call(this.eventContext||this.element,a):this.value.handleEvent(a)}}const eb=a=>a&&(cb?{capture:a.capture,passive:a.passive,once:a.once}:a.capture);const fb=new class{handleAttributeExpressions(a,b,c,d){const e=b[0];if("."===e){const d=new ab(a,b.slice(1),c);return d.parts}if("@"===e)return[new db(a,b.slice(1),d.eventContext)];if("?"===e)return[new $a(a,b.slice(1),c)];const f=new Xa(a,b,c);return f.parts}handleTextExpression(a){return new Za(a)}},gb=new Map,hb=new WeakMap,ib=(a,b,c)=>{let d=hb.get(b);d===void 0&&(Fa(b,b.firstChild),hb.set(b,d=new Za(Object.assign({templateFactory:i},c))),d.appendInto(b)),d.setValue(a),d.commit()};(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.1.2");const jb=(a,...b)=>new Ta(a,b,"html",fb),kb=(a,...b)=>new Ua(a,b,"svg",fb),lb=133,mb=a=>{let b=11===a.nodeType?0:1;for(const c=document.createTreeWalker(a,lb,null,!1);c.nextNode();)b++;return b},nb=(a,b=-1)=>{for(let c=b+1;c<a.length;c++){const b=a[c];if(Oa(b))return c}return-1},ob=(a,b)=>"".concat(a,"--").concat(b);let pb=!0;"undefined"==typeof window.ShadyCSS?pb=!1:"undefined"==typeof window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1."),pb=!1);const qb=a=>b=>{const c=ob(b.type,a);let d=gb.get(c);void 0===d&&(d={stringsArray:new WeakMap,keyString:new Map},gb.set(c,d));let e=d.stringsArray.get(b.strings);if(void 0!==e)return e;const f=b.strings.join(Ia);if(e=d.keyString.get(f),void 0===e){const c=b.getTemplateElement();pb&&window.ShadyCSS.prepareTemplateDom(c,a),e=new Ma(b,c),d.keyString.set(f,e)}return d.stringsArray.set(b.strings,e),e},rb=["html","svg"],sb=a=>{rb.forEach(b=>{const c=gb.get(ob(b,a));c!==void 0&&c.keyString.forEach(a=>{const{element:{content:b}}=a,c=new Set;Array.from(b.querySelectorAll("style")).forEach(a=>{c.add(a)}),H(a,c)})})},tb=new Set,ub=(a,b,c)=>{tb.add(a);const d=!c?document.createElement("template"):c.element,e=b.querySelectorAll("style"),{length:f}=e;if(0===f)return void window.ShadyCSS.prepareTemplateStyles(d,a);const g=document.createElement("style");for(let d=0;d<f;d++){const a=e[d];a.parentNode.removeChild(a),g.textContent+=a.textContent}sb(a);const h=d.content;!c?h.insertBefore(g,h.firstChild):I(c,g,h.firstChild),window.ShadyCSS.prepareTemplateStyles(d,a);const i=h.querySelector("style");if(window.ShadyCSS.nativeShadow&&null!==i)b.insertBefore(i.cloneNode(!0),b.firstChild);else if(!!c){h.insertBefore(g,h.firstChild);const a=new Set;a.add(g),H(c,a)}},vb=(a,b,c)=>{if(!c||"object"!=typeof c||!c.scopeName)throw new Error("The `scopeName` option is required.");const d=c.scopeName,e=hb.has(b),f=pb&&11===b.nodeType&&!!b.host,g=f&&!tb.has(d),h=g?document.createDocumentFragment():b;if(ib(a,h,Object.assign({templateFactory:qb(d)},c)),g){const a=hb.get(h);hb.delete(h);const c=a.value instanceof Ra?a.value.template:void 0;ub(d,h,c),Fa(b,b.firstChild),b.appendChild(h),hb.set(b,a)}!e&&f&&window.ShadyCSS.styleElement(b.host)};var wb;window.JSCompiler_renameProperty=a=>a;const xb={toAttribute(a,b){return b===Boolean?a?"":null:b===Object||b===Array?null==a?a:JSON.stringify(a):a},fromAttribute(a,b){return b===Boolean?null!==a:b===Number?null===a?null:+a:b===Object||b===Array?JSON.parse(a):a}},yb=(a,b)=>b!==a&&(b===b||a===a),zb={attribute:!0,type:String,converter:xb,reflect:!1,hasChanged:yb},Ab=Promise.resolve(!0),Bb=1,Cb=4,Db=8,Eb=16,Fb=32,Gb="finalized";class Hb extends HTMLElement{constructor(){super(),this._updateState=0,this._instanceProperties=void 0,this._updatePromise=Ab,this._hasConnectedResolver=void 0,this._changedProperties=new Map,this._reflectingProperties=void 0,this.initialize()}static get observedAttributes(){this.finalize();const a=[];return this._classProperties.forEach((b,c)=>{const d=this._attributeNameForProperty(c,b);void 0!==d&&(this._attributeToPropertyMap.set(d,c),a.push(d))}),a}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const a=Object.getPrototypeOf(this)._classProperties;a!==void 0&&a.forEach((a,b)=>this._classProperties.set(b,a))}}static createProperty(a,b=zb){if(this._ensureClassProperties(),this._classProperties.set(a,b),b.noAccessor||this.prototype.hasOwnProperty(a))return;const c="symbol"==typeof a?Symbol():"__".concat(a);Object.defineProperty(this.prototype,a,{get(){return this[c]},set(b){const d=this[a];this[c]=b,this._requestUpdate(a,d)},configurable:!0,enumerable:!0})}static finalize(){const a=Object.getPrototypeOf(this);if(a.hasOwnProperty(Gb)||a.finalize(),this[Gb]=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const a=this.properties,b=[].concat(L(Object.getOwnPropertyNames(a)),L("function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(a):[]));for(const c of b)this.createProperty(c,a[c])}}static _attributeNameForProperty(a,b){const c=b.attribute;return!1===c?void 0:"string"==typeof c?c:"string"==typeof a?a.toLowerCase():void 0}static _valueHasChanged(a,b,c=yb){return c(a,b)}static _propertyValueFromAttribute(a,b){const c=b.type,d=b.converter||xb,e="function"==typeof d?d:d.fromAttribute;return e?e(a,c):a}static _propertyValueToAttribute(a,b){if(void 0===b.reflect)return;const c=b.type,d=b.converter,e=d&&d.toAttribute||xb.toAttribute;return e(a,c)}initialize(){this._saveInstanceProperties(),this._requestUpdate()}_saveInstanceProperties(){this.constructor._classProperties.forEach((a,b)=>{if(this.hasOwnProperty(b)){const a=this[b];delete this[b],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(b,a)}})}_applyInstanceProperties(){this._instanceProperties.forEach((a,b)=>this[b]=a),this._instanceProperties=void 0}connectedCallback(){this._updateState|=Fb,this._hasConnectedResolver&&(this._hasConnectedResolver(),this._hasConnectedResolver=void 0)}disconnectedCallback(){}attributeChangedCallback(a,b,c){b!==c&&this._attributeToProperty(a,c)}_propertyToAttribute(a,b,c=zb){const d=this.constructor,e=d._attributeNameForProperty(a,c);if(e!==void 0){const a=d._propertyValueToAttribute(b,c);if(a===void 0)return;this._updateState|=Db,null==a?this.removeAttribute(e):this.setAttribute(e,a),this._updateState&=~Db}}_attributeToProperty(a,b){if(this._updateState&Db)return;const c=this.constructor,d=c._attributeToPropertyMap.get(a);if(d!==void 0){const a=c._classProperties.get(d)||zb;this._updateState|=Eb,this[d]=c._propertyValueFromAttribute(b,a),this._updateState&=~Eb}}_requestUpdate(a,b){let c=!0;if(a!==void 0){const d=this.constructor,e=d._classProperties.get(a)||zb;d._valueHasChanged(this[a],b,e.hasChanged)?(!this._changedProperties.has(a)&&this._changedProperties.set(a,b),!0===e.reflect&&!(this._updateState&Eb)&&(this._reflectingProperties===void 0&&(this._reflectingProperties=new Map),this._reflectingProperties.set(a,e))):c=!1}!this._hasRequestedUpdate&&c&&this._enqueueUpdate()}requestUpdate(a,b){return this._requestUpdate(a,b),this.updateComplete}async _enqueueUpdate(){this._updateState|=Cb;let a,b;const c=this._updatePromise;this._updatePromise=new Promise((c,d)=>{a=c,b=d});try{await c}catch(a){}this._hasConnected||(await new Promise(a=>this._hasConnectedResolver=a));try{const a=this.performUpdate();null!=a&&(await a)}catch(a){b(a)}a(!this._hasRequestedUpdate)}get _hasConnected(){return this._updateState&Fb}get _hasRequestedUpdate(){return this._updateState&Cb}get hasUpdated(){return this._updateState&Bb}performUpdate(){this._instanceProperties&&this._applyInstanceProperties();let a=!1;const b=this._changedProperties;try{a=this.shouldUpdate(b),a&&this.update(b)}catch(b){throw a=!1,b}finally{this._markUpdated()}a&&(!(this._updateState&Bb)&&(this._updateState|=Bb,this.firstUpdated(b)),this.updated(b))}_markUpdated(){this._changedProperties=new Map,this._updateState&=~Cb}get updateComplete(){return this._getUpdateComplete()}_getUpdateComplete(){return this._updatePromise}shouldUpdate(a){return!0}update(a){this._reflectingProperties!==void 0&&0<this._reflectingProperties.size&&(this._reflectingProperties.forEach((a,b)=>this._propertyToAttribute(b,this[b],a)),this._reflectingProperties=void 0)}updated(a){}firstUpdated(a){}}wb=Gb,Hb[wb]=!0;const Ib="adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Jb=Symbol();class Kb{constructor(a,b){if(b!==Jb)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=a}get styleSheet(){return void 0===this._styleSheet&&(Ib?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}const Lb=a=>{if(a instanceof Kb)return a.cssText;if("number"==typeof a)return a;throw new Error("Value passed to 'css' function must be a 'css' function result: ".concat(a,". Use 'unsafeCSS' to pass non-literal values, but\n            take care to ensure page security."))};(window.litElementVersions||(window.litElementVersions=[])).push("2.2.1");const Mb=a=>a.flat?a.flat(1/0):K(a);class Nb extends Hb{static finalize(){super.finalize.call(this),this._styles=this.hasOwnProperty(JSCompiler_renameProperty("styles",this))?this._getUniqueStyles():this._styles||[]}static _getUniqueStyles(){const a=this.styles,b=[];if(Array.isArray(a)){const c=Mb(a),d=c.reduceRight((a,b)=>(a.add(b),a),new Set);d.forEach(a=>b.unshift(a))}else a&&b.push(a);return b}initialize(){super.initialize(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow({mode:"open"})}adoptStyles(){const a=this.constructor._styles;0===a.length||(window.ShadyCSS===void 0||window.ShadyCSS.nativeShadow?Ib?this.renderRoot.adoptedStyleSheets=a.map(a=>a.styleSheet):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(a.map(a=>a.cssText),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&window.ShadyCSS!==void 0&&window.ShadyCSS.styleElement(this)}update(a){super.update(a);const b=this.render();b instanceof Ta&&this.constructor.render(b,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach(a=>{const b=document.createElement("style");b.textContent=a.cssText,this.renderRoot.appendChild(b)}))}render(){}}Nb.finalized=!0,Nb.render=vb;var Ob=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(a){}}();"undefined"==typeof Promise&&require("lie/polyfill");const Pb="local-forage-detect-blob-support";let Qb;const Rb={},Sb=Object.prototype.toString,Tb="readonly",Ub="readwrite";var Vb={_driver:"asyncStorage",_initStorage:function(a){function b(){return Promise.resolve()}var c=this,d={db:null};if(a)for(var e in a)d[e]=a[e];var f=Rb[d.name];f||(f=ia(),Rb[d.name]=f),f.forages.push(c),c._initReady||(c._initReady=c.ready,c.ready=fa);for(var g,h=[],i=0;i<f.forages.length;i++)g=f.forages[i],g!==c&&h.push(g._initReady().catch(b));var l=f.forages.slice(0);return Promise.all(h).then(function(){return d.db=f.db,_(d)}).then(function(a){return d.db=a,ba(d,c._defaultConfig.version)?aa(d):a}).then(function(a){d.db=f.db=a,c._dbInfo=d;for(var b,e=0;e<l.length;e++)b=l[e],b!==c&&(b._dbInfo.db=d.db,b._dbInfo.version=d.version)})},_support:function(){try{if(!Ob)return!1;var a="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),b="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!a||b)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(a){return!1}}(),iterate:function(a,b){var c=this,d=new Promise(function(b,d){c.ready().then(function(){ha(c._dbInfo,Tb,function(e,f){if(e)return d(e);try{var g=f.objectStore(c._dbInfo.storeName),h=g.openCursor(),i=1;h.onsuccess=function(){var c=h.result;if(c){var d=c.value;ea(d)&&(d=da(d));var e=a(d,c.key,i++);void 0===e?c.continue():b(e)}else b()},h.onerror=function(){d(h.error)}}catch(a){d(a)}})}).catch(d)});return N(d,b),d},getItem:function(a,b){var c=this;a=P(a);var d=new Promise(function(b,d){c.ready().then(function(){ha(c._dbInfo,Tb,function(e,f){if(e)return d(e);try{var g=f.objectStore(c._dbInfo.storeName),h=g.get(a);h.onsuccess=function(){var a=h.result;void 0===a&&(a=null),ea(a)&&(a=da(a)),b(a)},h.onerror=function(){d(h.error)}}catch(a){d(a)}})}).catch(d)});return N(d,b),d},setItem:function(a,b,c){var d=this;a=P(a);var e=new Promise(function(c,f){var g;d.ready().then(function(){return g=d._dbInfo,"[object Blob]"===Sb.call(b)?T(g.db).then(function(a){return a?b:ca(b)}):b}).then(function(b){ha(d._dbInfo,Ub,function(e,g){if(e)return f(e);try{var h=g.objectStore(d._dbInfo.storeName);null===b&&(b=void 0);var i=h.put(b,a);g.oncomplete=function(){void 0===b&&(b=null),c(b)},g.onabort=g.onerror=function(){var a=i.error?i.error:i.transaction.error;f(a)}}catch(a){f(a)}})}).catch(f)});return N(e,c),e},removeItem:function(a,b){var c=this;a=P(a);var d=new Promise(function(b,d){c.ready().then(function(){ha(c._dbInfo,Ub,function(e,f){if(e)return d(e);try{var g=f.objectStore(c._dbInfo.storeName),h=g.delete(a);f.oncomplete=function(){b()},f.onerror=function(){d(h.error)},f.onabort=function(){var a=h.error?h.error:h.transaction.error;d(a)}}catch(a){d(a)}})}).catch(d)});return N(d,b),d},clear:function(a){var b=this,c=new Promise(function(a,c){b.ready().then(function(){ha(b._dbInfo,Ub,function(d,e){if(d)return c(d);try{var f=e.objectStore(b._dbInfo.storeName),g=f.clear();e.oncomplete=function(){a()},e.onabort=e.onerror=function(){var a=g.error?g.error:g.transaction.error;c(a)}}catch(a){c(a)}})}).catch(c)});return N(c,a),c},length:function(a){var b=this,c=new Promise(function(a,c){b.ready().then(function(){ha(b._dbInfo,Tb,function(d,e){if(d)return c(d);try{var f=e.objectStore(b._dbInfo.storeName),g=f.count();g.onsuccess=function(){a(g.result)},g.onerror=function(){c(g.error)}}catch(a){c(a)}})}).catch(c)});return N(c,a),c},key:function(a,b){var c=this,d=new Promise(function(b,d){return 0>a?void b(null):void c.ready().then(function(){ha(c._dbInfo,Tb,function(e,f){if(e)return d(e);try{var g=f.objectStore(c._dbInfo.storeName),h=!1,i=g.openCursor();i.onsuccess=function(){var c=i.result;return c?void(0===a?b(c.key):h?b(c.key):(h=!0,c.advance(a))):void b(null)},i.onerror=function(){d(i.error)}}catch(a){d(a)}})}).catch(d)});return N(d,b),d},keys:function(a){var b=this,c=new Promise(function(a,c){b.ready().then(function(){ha(b._dbInfo,Tb,function(d,e){if(d)return c(d);try{var f=e.objectStore(b._dbInfo.storeName),g=f.openCursor(),h=[];g.onsuccess=function(){var b=g.result;return b?void(h.push(b.key),b.continue()):void a(h)},g.onerror=function(){c(g.error)}}catch(a){c(a)}})}).catch(c)});return N(c,a),c},dropInstance:function(a,b){b=Q.apply(this,arguments);var c=this.config();a="function"!=typeof a&&a||{},a.name||(a.name=a.name||c.name,a.storeName=a.storeName||c.storeName);var d,e=this;if(!a.name)d=Promise.reject("Invalid arguments");else{const b=a.name===c.name&&e._dbInfo.db,f=b?Promise.resolve(e._dbInfo.db):_(a).then(b=>{const c=Rb[a.name],d=c.forages;c.db=b;for(var e=0;e<d.length;e++)d[e]._dbInfo.db=b;return b});d=a.storeName?f.then(b=>{if(!b.objectStoreNames.contains(a.storeName))return;const c=b.version+1;U(a);const d=Rb[a.name],e=d.forages;b.close();for(let a=0;a<e.length;a++){const b=e[a];b._dbInfo.db=null,b._dbInfo.version=c}const f=new Promise((b,d)=>{const e=Ob.open(a.name,c);e.onerror=a=>{const b=e.result;b.close(),d(a)},e.onupgradeneeded=()=>{var b=e.result;b.deleteObjectStore(a.storeName)},e.onsuccess=()=>{const a=e.result;a.close(),b(a)}});return f.then(a=>{d.db=a;for(let b=0;b<e.length;b++){const c=e[b];c._dbInfo.db=a,W(c._dbInfo)}}).catch(b=>{throw(Z(a,b)||Promise.resolve()).catch(()=>{}),b})}):f.then(b=>{U(a);const c=Rb[a.name],d=c.forages;b.close();for(var e=0;e<d.length;e++){const a=d[e];a._dbInfo.db=null}const f=new Promise((b,c)=>{var d=Ob.deleteDatabase(a.name);d.onerror=d.onblocked=a=>{const b=d.result;b&&b.close(),c(a)},d.onsuccess=()=>{const a=d.result;a&&a.close(),b(a)}});return f.then(a=>{c.db=a;for(var b=0;b<d.length;b++){const a=d[b];W(a._dbInfo)}}).catch(b=>{throw(Z(a,b)||Promise.resolve()).catch(()=>{}),b})})}return N(d,b),d}},Wb=/^~~local_forage_type~([^~]+)~/,Xb="__lfsc__:".length,Yb=Xb+"arbf".length,Zb=Object.prototype.toString,$b={serialize:function(a,b){var c="";if(a&&(c=Zb.call(a)),a&&("[object ArrayBuffer]"===c||a.buffer&&"[object ArrayBuffer]"===Zb.call(a.buffer))){var d,e="__lfsc__:";a instanceof ArrayBuffer?(d=a,e+="arbf"):(d=a.buffer,"[object Int8Array]"===c?e+="si08":"[object Uint8Array]"===c?e+="ui08":"[object Uint8ClampedArray]"===c?e+="uic8":"[object Int16Array]"===c?e+="si16":"[object Uint16Array]"===c?e+="ur16":"[object Int32Array]"===c?e+="si32":"[object Uint32Array]"===c?e+="ui32":"[object Float32Array]"===c?e+="fl32":"[object Float64Array]"===c?e+="fl64":b(new Error("Failed to get type for BinaryArray"))),b(e+ka(d))}else if("[object Blob]"===c){var f=new FileReader;f.onload=function(){var c="~~local_forage_type~"+a.type+"~"+ka(this.result);b("__lfsc__:blob"+c)},f.readAsArrayBuffer(a)}else try{b(JSON.stringify(a))}catch(c){console.error("Couldn't convert value into a JSON string: ",a),b(null,c)}},deserialize:function(a){if(a.substring(0,Xb)!=="__lfsc__:")return JSON.parse(a);var b,c=a.substring(Yb),d=a.substring(Xb,Yb);if(d==="blob"&&Wb.test(c)){var e=c.match(Wb);b=e[1],c=c.substring(e[0].length)}var f=ja(c);switch(d){case"arbf":return f;case"blob":return M([f],{type:b});case"si08":return new Int8Array(f);case"ui08":return new Uint8Array(f);case"uic8":return new Uint8ClampedArray(f);case"si16":return new Int16Array(f);case"ur16":return new Uint16Array(f);case"si32":return new Int32Array(f);case"ui32":return new Uint32Array(f);case"fl32":return new Float32Array(f);case"fl64":return new Float64Array(f);default:throw new Error("Unkown type: "+d);}},stringToBuffer:ja,bufferToString:ka},_b={_driver:"webSQLStorage",_initStorage:function(a){var b=this,c={db:null};if(a)for(var d in a)c[d]="string"==typeof a[d]?a[d]:a[d].toString();var e=new Promise(function(a,d){try{c.db=openDatabase(c.name,c.version+"",c.description,c.size)}catch(a){return d(a)}c.db.transaction(function(e){la(e,c,function(){b._dbInfo=c,a()},function(a,b){d(b)})},d)});return c.serializer=$b,e},_support:function(){return"function"==typeof openDatabase}(),iterate:function(a,b){var c=this,d=new Promise(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){ma(c,e,"SELECT * FROM ".concat(e.storeName),[],function(c,d){for(var f=d.rows,g=f.length,h=0;h<g;h++){var j=f.item(h),k=j.value;if(k&&(k=e.serializer.deserialize(k)),k=a(k,j.key,h+1),void 0!==k)return void b(k)}b()},function(a,b){d(b)})})}).catch(d)});return N(d,b),d},getItem:function(a,b){var c=this;a=P(a);var d=new Promise(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){ma(c,e,"SELECT * FROM ".concat(e.storeName," WHERE key = ? LIMIT 1"),[a],function(a,c){var d=c.rows.length?c.rows.item(0).value:null;d&&(d=e.serializer.deserialize(d)),b(d)},function(a,b){d(b)})})}).catch(d)});return N(d,b),d},setItem:function(a,b,c){return na.apply(this,[a,b,c,1])},removeItem:function(a,b){var c=this;a=P(a);var d=new Promise(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){ma(c,e,"DELETE FROM ".concat(e.storeName," WHERE key = ?"),[a],function(){b()},function(a,b){d(b)})})}).catch(d)});return N(d,b),d},clear:function(a){var b=this,c=new Promise(function(a,c){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){ma(b,d,"DELETE FROM ".concat(d.storeName),[],function(){a()},function(a,b){c(b)})})}).catch(c)});return N(c,a),c},length:function(a){var b=this,c=new Promise(function(a,c){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){ma(b,d,"SELECT COUNT(key) as c FROM ".concat(d.storeName),[],function(b,c){var d=c.rows.item(0).c;a(d)},function(a,b){c(b)})})}).catch(c)});return N(c,a),c},key:function(a,b){var c=this,d=new Promise(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){ma(c,e,"SELECT key FROM ".concat(e.storeName," WHERE id = ? LIMIT 1"),[a+1],function(a,c){var d=c.rows.length?c.rows.item(0).key:null;b(d)},function(a,b){d(b)})})}).catch(d)});return N(d,b),d},keys:function(a){var b=this,c=new Promise(function(a,c){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){ma(b,d,"SELECT key FROM ".concat(d.storeName),[],function(b,c){for(var d=[],e=0;e<c.rows.length;e++)d.push(c.rows.item(e).key);a(d)},function(a,b){c(b)})})}).catch(c)});return N(c,a),c},dropInstance:function(a,b){b=Q.apply(this,arguments);var c=this.config();a="function"!=typeof a&&a||{},a.name||(a.name=a.name||c.name,a.storeName=a.storeName||c.storeName);var d,e=this;return d=a.name?new Promise(function(b){var d;d=a.name===c.name?e._dbInfo.db:openDatabase(a.name,"","",0),a.storeName?b({db:d,storeNames:[a.storeName]}):b(oa(d))}).then(function(a){return new Promise(function(b,c){a.db.transaction(function(d){function e(a){return new Promise(function(b,c){d.executeSql("DROP TABLE IF EXISTS ".concat(a),[],function(){b()},function(a,b){c(b)})})}for(var f=[],g=0,h=a.storeNames.length;g<h;g++)f.push(e(a.storeNames[g]));Promise.all(f).then(function(){b()}).catch(function(a){c(a)})},function(a){c(a)})})}):Promise.reject("Invalid arguments"),N(d,b),d}},ac={_driver:"localStorageWrapper",_initStorage:function(a){var b=this,c={};if(a)for(var d in a)c[d]=a[d];return(c.keyPrefix=qa(a,b._defaultConfig),!sa())?Promise.reject():(b._dbInfo=c,c.serializer=$b,Promise.resolve())},_support:pa(),iterate:function(a,b){var c=this,d=c.ready().then(function(){for(var b,d=c._dbInfo,e=d.keyPrefix,f=e.length,g=localStorage.length,h=1,j=0;j<g;j++)if(b=localStorage.key(j),0===b.indexOf(e)){var k=localStorage.getItem(b);if(k&&(k=d.serializer.deserialize(k)),k=a(k,b.substring(f),h++),void 0!==k)return k}});return N(d,b),d},getItem:function(a,b){var c=this;a=P(a);var d=c.ready().then(function(){var b=c._dbInfo,d=localStorage.getItem(b.keyPrefix+a);return d&&(d=b.serializer.deserialize(d)),d});return N(d,b),d},setItem:function(a,b,c){var d=this;a=P(a);var e=d.ready().then(function(){void 0===b&&(b=null);var c=b;return new Promise(function(e,f){var g=d._dbInfo;g.serializer.serialize(b,function(b,d){if(d)f(d);else try{localStorage.setItem(g.keyPrefix+a,b),e(c)}catch(a){("QuotaExceededError"===a.name||"NS_ERROR_DOM_QUOTA_REACHED"===a.name)&&f(a),f(a)}})})});return N(e,c),e},removeItem:function(a,b){var c=this;a=P(a);var d=c.ready().then(function(){var b=c._dbInfo;localStorage.removeItem(b.keyPrefix+a)});return N(d,b),d},clear:function(a){var b=this,c=b.ready().then(function(){for(var a,c=b._dbInfo.keyPrefix,d=localStorage.length-1;0<=d;d--)a=localStorage.key(d),0===a.indexOf(c)&&localStorage.removeItem(a)});return N(c,a),c},length:function(a){var b=this,c=b.keys().then(function(a){return a.length});return N(c,a),c},key:function(a,b){var c=this,d=c.ready().then(function(){var b,d=c._dbInfo;try{b=localStorage.key(a)}catch(a){b=null}return b&&(b=b.substring(d.keyPrefix.length)),b});return N(d,b),d},keys:function(a){var b=this,c=b.ready().then(function(){for(var a,c=b._dbInfo,d=localStorage.length,e=[],f=0;f<d;f++)a=localStorage.key(f),0===a.indexOf(c.keyPrefix)&&e.push(a.substring(c.keyPrefix.length));return e});return N(c,a),c},dropInstance:function(a,b){if(b=Q.apply(this,arguments),a="function"!=typeof a&&a||{},!a.name){var c=this.config();a.name=a.name||c.name,a.storeName=a.storeName||c.storeName}var d,e=this;return d=a.name?new Promise(function(b){a.storeName?b(qa(a,e._defaultConfig)):b("".concat(a.name,"/"))}).then(function(a){for(var b,c=localStorage.length-1;0<=c;c--)b=localStorage.key(c),0===b.indexOf(a)&&localStorage.removeItem(b)}):Promise.reject("Invalid arguments"),N(d,b),d}};const bc=(a,b)=>a===b||"number"==typeof a&&"number"==typeof b&&isNaN(a)&&isNaN(b),cc=(a,b)=>{const c=a.length;for(let d=0;d<c;){if(bc(a[d],b))return!0;d++}return!1},dc=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},ec={},fc={},gc={INDEXEDDB:Vb,WEBSQL:_b,LOCALSTORAGE:ac},hc=[gc.INDEXEDDB._driver,gc.WEBSQL._driver,gc.LOCALSTORAGE._driver],ic=["dropInstance"],jc=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ic),kc={description:"",driver:hc.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};class lc{constructor(a){for(let b in gc)if(gc.hasOwnProperty(b)){const a=gc[b],c=a._driver;this[b]=c,ec[c]||this.defineDriver(a)}this._defaultConfig=ua({},kc),this._config=ua({},this._defaultConfig,a),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(()=>{})}config(a){if("object"==typeof a){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(let b in a){if("storeName"==b&&(a[b]=a[b].replace(/\W/g,"_")),"version"==b&&"number"!=typeof a[b])return new Error("Database version must be a number.");this._config[b]=a[b]}return!("driver"in a&&a.driver)||this.setDriver(this._config.driver)}return"string"==typeof a?this._config[a]:this._config}defineDriver(a,b,c){const d=new Promise(function(b,c){try{const d=a._driver,e=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!a._driver)return void c(e);const f=jc.concat("_initStorage");for(let b=0,d=f.length;b<d;b++){const d=f[b],g=!cc(ic,d);if((g||a[d])&&"function"!=typeof a[d])return void c(e)}(function(){const b=function(a){return function(){const b=new Error("Method ".concat(a," is not implemented by the current driver")),c=Promise.reject(b);return N(c,arguments[arguments.length-1]),c}};for(let c=0,d=ic.length;c<d;c++){const d=ic[c];a[d]||(a[d]=b(d))}})();const g=function(c){ec[d]&&console.info("Redefining LocalForage driver: ".concat(d)),ec[d]=a,fc[d]=c,b()};"_support"in a?a._support&&"function"==typeof a._support?a._support().then(g,c):g(!!a._support):g(!0)}catch(a){c(a)}});return O(d,b,c),d}driver(){return this._driver||null}getDriver(a,b,c){const d=ec[a]?Promise.resolve(ec[a]):Promise.reject(new Error("Driver not found."));return O(d,b,c),d}getSerializer(a){const b=Promise.resolve($b);return O(b,a),b}ready(a){const b=this,c=b._driverSet.then(()=>(null===b._ready&&(b._ready=b._initDriver()),b._ready));return O(c,a,a),c}setDriver(a,b,c){function d(){g._config.driver=g.driver()}function e(a){return g._extend(a),d(),g._ready=g._initStorage(g._config),g._ready}function f(a){return function(){function b(){for(;c<a.length;){let d=a[c];return c++,g._dbInfo=null,g._ready=null,g.getDriver(d).then(e).catch(b)}d();const f=new Error("No available storage method found.");return g._driverSet=Promise.reject(f),g._driverSet}let c=0;return b()}}const g=this;dc(a)||(a=[a]);const h=this._getSupportedDrivers(a),i=null===this._driverSet?Promise.resolve():this._driverSet.catch(()=>Promise.resolve());return this._driverSet=i.then(()=>{const a=h[0];return g._dbInfo=null,g._ready=null,g.getDriver(a).then(a=>{g._driver=a._driver,d(),g._wrapLibraryMethodsWithReady(),g._initDriver=f(h)})}).catch(()=>{d();const a=new Error("No available storage method found.");return g._driverSet=Promise.reject(a),g._driverSet}),O(this._driverSet,b,c),this._driverSet}supports(a){return!!fc[a]}_extend(a){ua(this,a)}_getSupportedDrivers(a){const b=[];for(let c=0,d=a.length;c<d;c++){const d=a[c];this.supports(d)&&b.push(d)}return b}_wrapLibraryMethodsWithReady(){for(let a=0,b=jc.length;a<b;a++)ta(this,jc[a])}createInstance(a){return new lc(a)}}var mc=new lc;let nc=String.fromCharCode;const oc=a=>pc(a,16,function(b){return nc(b)}),pc=(a,b,c)=>{if(null==a)return"";let d,e,f,g={},h={},j="",k="",l="",m=2,n=3,o=2,p=[],q=0,r=0;for(f=0;f<a.length;f+=1)if(j=a.charAt(f),Object.prototype.hasOwnProperty.call(g,j)||(g[j]=n++,h[j]=!0),k=l+j,Object.prototype.hasOwnProperty.call(g,k))l=k;else{if(Object.prototype.hasOwnProperty.call(h,l)){if(256>l.charCodeAt(0)){for(d=0;d<o;d++)q<<=1,r==b-1?(r=0,p.push(c(q)),q=0):r++;for(e=l.charCodeAt(0),d=0;8>d;d++)q=q<<1|1&e,r==b-1?(r=0,p.push(c(q)),q=0):r++,e>>=1}else{for(e=1,d=0;d<o;d++)q=q<<1|e,r==b-1?(r=0,p.push(c(q)),q=0):r++,e=0;for(e=l.charCodeAt(0),d=0;16>d;d++)q=q<<1|1&e,r==b-1?(r=0,p.push(c(q)),q=0):r++,e>>=1}m--,0==m&&(m=Aa(2,o),o++),delete h[l]}else for(e=g[l],d=0;d<o;d++)q=q<<1|1&e,r==b-1?(r=0,p.push(c(q)),q=0):r++,e>>=1;m--,0==m&&(m=Aa(2,o),o++),g[k]=n++,l=j+""}if(""!==l){if(Object.prototype.hasOwnProperty.call(h,l)){if(256>l.charCodeAt(0)){for(d=0;d<o;d++)q<<=1,r==b-1?(r=0,p.push(c(q)),q=0):r++;for(e=l.charCodeAt(0),d=0;8>d;d++)q=q<<1|1&e,r==b-1?(r=0,p.push(c(q)),q=0):r++,e>>=1}else{for(e=1,d=0;d<o;d++)q=q<<1|e,r==b-1?(r=0,p.push(c(q)),q=0):r++,e=0;for(e=l.charCodeAt(0),d=0;16>d;d++)q=q<<1|1&e,r==b-1?(r=0,p.push(c(q)),q=0):r++,e>>=1}m--,0==m&&(m=Aa(2,o),o++),delete h[l]}else for(e=g[l],d=0;d<o;d++)q=q<<1|1&e,r==b-1?(r=0,p.push(c(q)),q=0):r++,e>>=1;m--,0==m&&(m=Aa(2,o),o++)}for(e=2,d=0;d<o;d++)q=q<<1|1&e,r==b-1?(r=0,p.push(c(q)),q=0):r++,e>>=1;for(;;)if(q<<=1,r==b-1){p.push(c(q));break}else r++;return p.join("")},qc=a=>null==a?"":""==a?null:rc(a.length,32768,function(b){return a.charCodeAt(b)}),rc=(a,b,d)=>{let e,f,g,h,j,k,l,m,n=[],o=4,p=4,q=3,r="",s=[],t={val:d(0),position:b,index:1};for(f=0;3>f;f+=1)n[f]=f;for(h=0,k=Aa(2,2),l=1;l!=k;)j=t.val&t.position,t.position>>=1,0==t.position&&(t.position=b,t.val=d(t.index++)),h|=(0<j?1:0)*l,l<<=1;switch(e=h){case 0:for(h=0,k=Aa(2,8),l=1;l!=k;)j=t.val&t.position,t.position>>=1,0==t.position&&(t.position=b,t.val=d(t.index++)),h|=(0<j?1:0)*l,l<<=1;m=nc(h);break;case 1:for(h=0,k=Aa(2,16),l=1;l!=k;)j=t.val&t.position,t.position>>=1,0==t.position&&(t.position=b,t.val=d(t.index++)),h|=(0<j?1:0)*l,l<<=1;m=nc(h);break;case 2:return"";}for(n[3]=m,g=m,s.push(m);;){if(t.index>a)return"";for(h=0,k=Aa(2,q),l=1;l!=k;)j=t.val&t.position,t.position>>=1,0==t.position&&(t.position=b,t.val=d(t.index++)),h|=(0<j?1:0)*l,l<<=1;switch(m=h){case 0:for(h=0,k=Aa(2,8),l=1;l!=k;)j=t.val&t.position,t.position>>=1,0==t.position&&(t.position=b,t.val=d(t.index++)),h|=(0<j?1:0)*l,l<<=1;n[p++]=nc(h),m=p-1,o--;break;case 1:for(h=0,k=Aa(2,16),l=1;l!=k;)j=t.val&t.position,t.position>>=1,0==t.position&&(t.position=b,t.val=d(t.index++)),h|=(0<j?1:0)*l,l<<=1;n[p++]=nc(h),m=p-1,o--;break;case 2:return s.join("");}if(0==o&&(o=Aa(2,q),q++),n[m])r=n[m];else if(m===p)r=g+g.charAt(0);else return null;s.push(r),n[p++]=g+r.charAt(0),o--,g=r,0==o&&(o=Aa(2,q),q++)}},sc=(a,b)=>a.reduce((a,c)=>+c[b]<+a[b]?c:a,a[0]),tc=(a,b)=>a.reduce((a,c)=>a+ +c[b],0)/a.length,uc=(a,b)=>a.reduce((a,c)=>+c[b]>+a[b]?c:a,a[0]),vc=(a,b,c="en-US")=>a.toLocaleString(c,J({hour:"numeric",minute:"numeric"},b)),wc=a=>a*3600*1000,xc=(c,a,b)=>{const d=+c.replace("#","0x"),e=d>>16,f=255&d>>8,g=255&d,h=+a.replace("#","0x");return"#".concat((0|16777216+(e+b*((h>>16)-e)<<16)+(f+b*((255&h>>8)-f)<<8)+(g+b*((255&h)-g))).toString(16).slice(1))},yc=a=>oc(JSON.stringify(a)),zc=a=>"string"==typeof a?JSON.parse(qc(a)):a,Ac=(...a)=>a.find(a=>"undefined"!=typeof a),Bc=(c,a)=>c.length===a.length&&c.every((b,c)=>b===a[c]),Cc="https://github.com/kalkih/mini-graph-card/blob/master/README.md",Dc=14,Ec=96,Fc={humidity:"hass:water-percent",illuminance:"hass:brightness-5",temperature:"hass:thermometer",battery:"hass:battery",pressure:"hass:gauge",power:"hass:flash",signal_strength:"hass:wifi",motion:"hass:walk",door:"hass:door-closed",window:"hass:window-closed",presence:"hass:account",light:"hass:lightbulb"},Gc=["var(--accent-color)","#3498db","#e74c3c","#9b59b6","#f1c40f","#2ecc71","#1abc9c","#34495e","#e67e22","#7f8c8d","#27ae60","#2980b9","#8e44ad"],Hc=["entity","line","length","fill","points","tooltip","abs","config"],Ic={name:!0,icon:!0,state:!0,graph:"line",labels:"hover",labels_secondary:"hover",extrema:!1,legend:!0,fill:!0,points:"hover"},Jc=0,X=1,Y=2,V=3600000;class Kc{constructor(a,b,c,d=24,e=1,f="avg",g="interval",h=!0){const i={avg:this._average,max:this._maximum,min:this._minimum};this._history=void 0,this.coords=[],this.width=a-2*c[Jc],this.height=b-4*c[X],this.margin=c,this._max=0,this._min=0,this.points=e,this.hours=d,this._calcPoint=i[f]||this._average,this._smoothing=h,this._groupBy=g,this._endTime=0}get max(){return this._max}set max(a){this._max=a}get min(){return this._min}set min(a){this._min=a}set history(a){this._history=a}update(a=void 0){if(a&&(this._history=a),!this._history)return;this._updateEndTime();const b=this._history.reduce((a,b)=>this._reducer(a,b),[]),c=za(this.hours*this.points);b.length=c,this.coords=this._calcPoints(b),this.min=ya.apply(Math,L(this.coords.map(a=>+a[Y]))),this.max=xa.apply(Math,L(this.coords.map(a=>+a[Y])))}_reducer(a,b){var c=Math.floor;const d=this._endTime-new Date(b.last_changed).getTime(),e=d/V*this.points-this.hours*this.points,f=c(wa(e));return a[f]||(a[f]=[]),a[f].push(b),a}_calcPoints(a){const b=[];let c=this.width/(this.hours*this.points-1);c=Number.isFinite(c)?c:this.width;const d=a.filter(Boolean)[0];let e=[this._calcPoint(d),this._last(d)];const f=(a,d)=>{const f=c*d+this.margin[Jc];return a&&(e=[this._calcPoint(a),this._last(a)]),b.push([f,0,a?e[0]:e[1]])};for(let b=0;b<a.length;b+=1)f(a[b],b);return b}_calcY(a){const b=(this.max-this.min)/this.height||1;return a.map(a=>[a[Jc],this.height-(a[Y]-this.min)/b+2*this.margin[X],a[Y]])}getPoints(){let{coords:a}=this;1===a.length&&(a[1]=[this.width+this.margin[Jc],0,a[0][Y]]),a=this._calcY(this.coords);let b,c,d=a[0];a.shift();const e=a.map((a,e)=>{b=a,c=this._smoothing?this._midPoint(d[Jc],d[X],b[Jc],b[X]):b;const f=this._smoothing?(b[Y]+d[Y])/2:b[Y];return d=b,[c[Jc],c[X],f,e+1]});return e}getPath(){let{coords:a}=this;1===a.length&&(a[1]=[this.width+this.margin[Jc],0,a[0][Y]]),a=this._calcY(this.coords);let b,c,d="",e=a[0];return d+="M".concat(e[Jc],",").concat(e[X]),a.forEach(a=>{b=a,c=this._smoothing?this._midPoint(e[Jc],e[X],b[Jc],b[X]):b,d+=" ".concat(c[Jc],",").concat(c[X]),d+=" Q ".concat(b[Jc],",").concat(b[X]),e=b}),d+=" ".concat(b[Jc],",").concat(b[X]),d}computeGradient(a){const b=this._max-this._min;return a.map((a,c,d)=>{let e;if(a.value>this._max&&d[c+1]){const b=(this._max-d[c+1].value)/(a.value-d[c+1].value);e=xc(d[c+1].color,a.color,b)}else if(a.value<this._min&&d[c-1]){const b=(d[c-1].value-this._min)/(d[c-1].value-a.value);e=xc(d[c-1].color,a.color,b)}return{color:e||a.color,offset:0>=b?0:(this._max-a.value)*(100/b)}})}getFill(a){const b=this.height+4*this.margin[X];let c=a;return c+=" L ".concat(this.width-2*this.margin[Jc],", ").concat(b),c+=" L ".concat(this.coords[0][Jc],", ").concat(b," z"),c}getBars(a,b){const c=this._calcY(this.coords),d=4,e=(this.width-d)/za(this.hours*this.points)/b;return c.map((c,f)=>({x:e*f*b+e*a+d,y:c[X],height:this.height-c[X]+4*this.margin[X],width:e-d,value:c[Y]}))}_midPoint(a,b,c,d){return[(a-c)/2+c,(b-d)/2+d]}_average(a){return a.reduce((a,b)=>a+parseFloat(b.state),0)/a.length}_maximum(a){return xa.apply(Math,L(a.map(a=>a.state)))}_minimum(a){return ya.apply(Math,L(a.map(a=>a.state)))}_last(a){return parseFloat(a[a.length-1].state)||0}_updateEndTime(){switch(this._endTime=new Date,this._groupBy){case"date":this._endTime.setDate(this._endTime.getDate()+1),this._endTime.setHours(0,0);break;case"hour":this._endTime.setHours(this._endTime.getHours()+1),this._endTime.setMinutes(0,0,0);break;default:}}}const Lc=((a,...b)=>{const c=b.reduce((b,c,d)=>b+Lb(c)+a[d+1],a[0]);return new Kb(c,Jb)})(G());var Mc=(a,b,c,d,f)=>{let g;switch(d.action){case"more-info":{g=new Event("hass-more-info",{composed:!0}),g.detail={entityId:f},a.dispatchEvent(g);break}case"navigate":{if(!d.navigation_path)return;window.history.pushState(null,"",d.navigation_path),g=new Event("location-changed",{composed:!0}),g.detail={replace:!1},window.dispatchEvent(g);break}case"call-service":{if(!d.service)return;const[a,c]=d.service.split(".",2),e=J({},d.service_data);b.callService(a,c,e);break}case"url":{if(!d.url)return;window.location.href=d.url}}};mc.config({name:"mini-graph-card",version:1,storeName:"entity_history_cache",description:"Mini graph card uses caching for the entity history"}),mc.iterate((a,b)=>{const c=b.endsWith("-raw")?a:zc(a),d=new Date;d.setHours(d.getHours()-c.hours_to_show),new Date(c.last_fetched)<d&&mc.removeItem(b)}).catch(a=>{console.log("Purging has errored:",a)});class Nc extends Nb{constructor(){super(),this.id=Math.random().toString(36).substr(2,9),this.config={},this.bound=[0,0],this.boundSecondary=[0,0],this.min={},this.avg={},this.max={},this.length=[],this.entity=[],this.line=[],this.bar=[],this.fill=[],this.points=[],this.gradient=[],this.tooltip={},this.updateQueue=[],this.updating=!1,this.stateChanged=!1}static get styles(){return Lc}set hass(a){this._hass=a;let b=!1;this.config.entities.forEach((c,d)=>{this.config.entities[d].index=d;const e=a.states[c.entity];e&&this.entity[d]!==e&&(this.entity[d]=e,this.updateQueue.push(e.entity_id),b=!0)}),b&&(this.entity=L(this.entity),this.config.update_interval||this.updating?this.stateChanged=!0:this.updateData())}static get properties(){return{id:String,_hass:{},config:{},entity:[],Graph:[],line:[],shadow:[],length:Number,bound:[],boundSecondary:[],abs:[],tooltip:{},updateQueue:[],color:String}}setConfig(a){if(a.entity)throw new Error("The \"entity\" option was removed, please use \"entities\".\n See ".concat(Cc));if(!Array.isArray(a.entities))throw new Error("Please provide the \"entities\" option as a list.\n See ".concat(Cc));if(a.line_color_above||a.line_color_below)throw new Error("\"line_color_above/line_color_below\" was removed, please use \"color_thresholds\".\n See ".concat(Cc));const b=J({animate:!1,hour24:!1,font_size:Dc,font_size_header:14,height:100,hours_to_show:24,points_per_hour:.5,aggregate_func:"avg",group_by:"interval",line_color:[].concat(Gc),color_thresholds:[],color_thresholds_transition:"smooth",line_width:5,compress:!0,smoothing:!0,state_map:[],cache:!0,tap_action:{action:"more-info"}},a,{show:J({},Ic,{},a.show)});b.entities.forEach((a,c)=>{"string"==typeof a&&(b.entities[c]={entity:a})}),b.state_map.forEach((a,c)=>{"string"==typeof a&&(b.state_map[c]={value:a,label:a}),b.state_map[c].label=b.state_map[c].label||b.state_map[c].value}),"string"==typeof a.line_color&&(b.line_color=[a.line_color].concat(Gc)),b.font_size=a.font_size/100*Dc||Dc,b.color_thresholds=this.computeThresholds(b.color_thresholds,b.color_thresholds_transition);const c=24<b.hours_to_show?{day:"numeric",weekday:"short"}:{};switch(b.format=J({hour12:!b.hour24},c),b.group_by){case"date":b.points_per_hour=1/24;break;case"hour":b.points_per_hour=1;break;default:}if("bar"===b.show.graph){const a=b.entities.length;b.hours_to_show*b.points_per_hour*a>Ec&&(b.points_per_hour=Ec/(b.hours_to_show*a),console.warn("mini-graph-card: Not enough space, adjusting points_per_hour to ",b.points_per_hour))}const d=!Bc(this.config.entities||[],b.entities);this.config=b,(!this.Graph||d)&&(this._hass&&(this.hass=this._hass),this.Graph=b.entities.map(c=>new Kc(500,b.height,[b.show.fill?0:b.line_width,b.line_width],b.hours_to_show,b.points_per_hour,c.aggregate_func||b.aggregate_func,b.group_by,Ac(c.smoothing,a.smoothing,!c.entity.startsWith("binary_sensor.")))))}connectedCallback(){super.connectedCallback(),this.config.update_interval&&(this.updateOnInterval(),this.interval=setInterval(()=>this.updateOnInterval(),1e3*this.config.update_interval))}disconnectedCallback(){this.interval&&clearInterval(this.interval),super.disconnectedCallback()}shouldUpdate(a){return!!this.entity[0]&&(Hc.some(b=>a.has(b))?(this.color=this.intColor(void 0===this.tooltip.value?this.entity[0].state:this.tooltip.value,this.tooltip.entity||0),!0):void 0)}updated(a){this.config.animate&&a.has("line")&&(this.length.length<this.entity.length?(this.shadowRoot.querySelectorAll("svg path.line").forEach(a=>{this.length[a.id]=a.getTotalLength()}),this.length=L(this.length)):this.length=Array(this.entity.length).fill("none"))}render({config:a}=this){return jb(F(),a.group,a.show.graph&&a.show.fill,"hover"===a.show.points,"hover"===a.show.labels,"hover"===a.show.labels_secondary,0<a.color_thresholds.length,"none"!==a.tap_action.action,a.font_size,b=>this.handlePopup(b,a.tap_action.entity||this.entity[0]),this.renderHeader(),this.renderStates(),this.renderGraph(),this.renderInfo())}renderHeader(){const{show:a,align_icon:b,align_header:c,font_size_header:d}=this.config;return a.name||a.icon&&"state"!==b?jb(E(),c,d,this.renderName(),"state"===b?"":this.renderIcon()):""}renderIcon(){const{icon:a,icon_adaptive_color:b}=this.config.show;return a?jb(D(),this.config.align_icon,b?"color: ".concat(this.color,";"):"",this.computeIcon(this.entity[0])):""}renderName(){if(!this.config.show.name)return;const a=this.tooltip.entity===void 0?this.config.name||this.computeName(0):this.computeName(this.tooltip.entity),b=this.config.show.name_adaptive_color?"opacity: 1; color: ".concat(this.color,";"):"";return jb(C(),b,a)}renderStates(){const{entity:a,value:b}=this.tooltip,c=b===void 0?this.entity[0].state:b,d=this.config.entities[0].state_adaptive_color?"color: ".concat(this.color,";"):"";if(this.config.show.state)return jb(B(),this.config.align_state,d,this.computeState(c),d,this.computeUom(a||0),this.renderStateTime(),this.config.entities.map((a,b)=>this.renderState(a,b)),"state"===this.config.align_icon?this.renderIcon():"")}renderState(a,b){if(a.show_state&&0!==b){const{state:c}=this.entity[b];return jb(A(),a=>this.handlePopup(a,this.entity[b]),a.state_adaptive_color?"color: ".concat(this.computeColor(c,b),";"):"",a.show_indicator?this.renderIndicator(c,b):"",this.computeState(c),this.computeUom(b))}}renderStateTime(){return void 0===this.tooltip.value?void 0:jb(z(),this.tooltip.label?jb(y(),this.tooltip.label):jb(x(),this.tooltip.time[0],this.tooltip.time[1]))}renderGraph(){return this.config.show.graph?jb(w(),this.renderLabels(),this.renderLabelsSecondary(),this.renderSvg(),this.renderLegend()):""}renderLegend(){return 1>=this.visibleLegends.length||!this.config.show.legend?void 0:jb(v(),this.visibleLegends.map(a=>jb(u(),b=>this.handlePopup(b,this.entity[a.index]),()=>this.setTooltip(a.index,-1,this.entity[a.index].state,"Current"),()=>this.tooltip={},this.renderIndicator(this.entity[a.index].state,a.index),this.computeName(a.index))))}renderIndicator(a,b){return kb(t(),this.intColor(a,b))}renderSvgFill(a,b){if(!a)return;const c="fade"===this.config.show.fill,d=this.length[b]||!1===this.config.entities[b].show_line;return kb(s(),"fill-grad-".concat(this.id,"-").concat(b),"fill-grad-mask-".concat(this.id,"-").concat(b),"url(#fill-grad-".concat(this.id,"-").concat(b,")"),"fill-".concat(this.id,"-").concat(b),this.config.show.fill,b,this.config.animate,d,this.config.animate?"".concat(.5*b,"s"):"0s",c?"url(#fill-grad-mask-".concat(this.id,"-").concat(b,")"):"",this.fill[b])}renderSvgLine(a,b){if(a){const a=kb(r(),b,this.config.animate,this.length[b],this.config.animate?"".concat(.5*b,"s"):"0s",this.length[b]||"none",this.length[b]||"none","white",this.config.line_width,this.line[b]);return kb(q(),"line-".concat(this.id,"-").concat(b),a)}}renderSvgPoint(a,b){const c=this.gradient[b]?this.computeColor(a[Y],b):"inherit";return kb(p(),this.tooltip.index!==a[3],"--mcg-hover: ".concat(c,";"),c,c,a[Jc],a[X],this.config.line_width,()=>this.setTooltip(b,a[3],a[Y]),()=>this.tooltip={})}renderSvgPoints(a,b){if(a){const c=this.computeColor(this.entity[b].state,b);return kb(o(),this.tooltip.entity===b,void 0!==this.tooltip.entity&&this.tooltip.entity!==b,this.length[b],this.config.animate&&"hover"!==this.config.show.points,this.config.animate?"".concat(.5*b+.5,"s"):"0s",c,c,this.config.line_width/2,a.map(a=>this.renderSvgPoint(a,b)))}}renderSvgGradient(a){if(a){const b=a.map((a,b)=>a?kb(n(),"grad-".concat(this.id,"-").concat(b),a.map(a=>kb(m(),a.color,"".concat(a.offset,"%")))):void 0);return kb(l(),b)}}renderSvgLineRect(a,b){if(a){const a=this.gradient[b]?"url(#grad-".concat(this.id,"-").concat(b,")"):this.computeColor(this.entity[b].state,b);return kb(k(),void 0!==this.tooltip.entity&&this.tooltip.entity!==b,"rect-".concat(this.id,"-").concat(b),a,"url(#line-".concat(this.id,"-").concat(b,")"))}}renderSvgFillRect(a,b){if(a){const a=this.gradient[b]?"url(#grad-".concat(this.id,"-").concat(b,")"):this.intColor(this.entity[b].state,b);return kb(j(),void 0!==this.tooltip.entity&&this.tooltip.entity!==b,"fill-rect-".concat(this.id,"-").concat(b),a,"url(#fill-".concat(this.id,"-").concat(b,")"))}}renderSvgBars(a,b){if(a){const c=a.map((a,c)=>{const d=this.config.animate?kb(h(),this.config.height,a.y):"",e=this.computeColor(a.value,b);return kb(g(),a.x,a.y,a.height,a.width,e,()=>this.setTooltip(b,c,a.value),()=>this.tooltip={},d)});return kb(f(),this.config.animate,c)}}renderSvg(){const{height:a}=this.config;return kb(e(),0===a?0:"100%",a,a=>a.stopPropagation(),this.renderSvgGradient(this.gradient),this.fill.map((a,b)=>this.renderSvgFill(a,b)),this.fill.map((a,b)=>this.renderSvgFillRect(a,b)),this.line.map((a,b)=>this.renderSvgLine(a,b)),this.line.map((a,b)=>this.renderSvgLineRect(a,b)),this.bar.map((a,b)=>this.renderSvgBars(a,b)),this.points.map((a,b)=>this.renderSvgPoints(a,b)))}setTooltip(a,b,c,d=null){const{points_per_hour:e,hours_to_show:f,format:g}=this.config,h=1>f&&1>e?e*f:1/e,i=wa(b+1-za(f*e)),j=this.getEndDate(),k=1/60;j.setMilliseconds(j.getMilliseconds()-wc(h*i+k));const l=vc(j,{hour12:!this.config.hour24},this._hass.language);j.setMilliseconds(j.getMilliseconds()-wc(h-k));const m=vc(j,g,this._hass.language);this.tooltip={value:c,id:i,entity:a,time:[m,l],index:b,label:d}}renderLabels(){return this.config.show.labels&&0!==this.primaryYaxisSeries.length?jb(d(),this.computeState(this.bound[1]),this.computeState(this.bound[0])):void 0}renderLabelsSecondary(){return this.config.show.labels_secondary&&0!==this.secondaryYaxisSeries.length?jb(c(),this.computeState(this.boundSecondary[1]),this.computeState(this.boundSecondary[0])):void 0}renderInfo(){const c=[];return this.config.show.extrema&&c.push(this.min),this.config.show.average&&c.push(this.avg),this.config.show.extrema&&c.push(this.max),c.length?jb(b(),c.map(b=>jb(a(),b.type,this.computeState(b.state),this.computeUom(0),"avg"===b.type?"":vc(new Date(b.last_changed),this.config.format,this._hass.language)))):void 0}handlePopup(a,b){a.stopPropagation(),Mc(this,this._hass,this.config,this.config.tap_action,b.entity_id||b)}computeThresholds(a,b){if(a.sort((c,a)=>a.value-c.value),"smooth"===b)return a;else{var c;const b=(c=[]).concat.apply(c,L(a.map((b,c)=>[b,{value:b.value-1e-4,color:a[c+1]?a[c+1].color:b.color}])));return b}}computeColor(a,b){const{color_thresholds:c,line_color:d}=this.config,e=J({color:d[b]||d[0]},c.slice(-1)[0],{},c.find(b=>b.value<(+a||0)));return this.config.entities[b].color||e.color}get visibleEntities(){return this.config.entities.filter(a=>!1!==a.show_graph)}get primaryYaxisEntities(){return this.visibleEntities.filter(a=>a.y_axis===void 0||"primary"===a.y_axis)}get secondaryYaxisEntities(){return this.visibleEntities.filter(a=>"secondary"===a.y_axis)}get visibleLegends(){return this.visibleEntities.filter(a=>!1!==a.show_legend)}get primaryYaxisSeries(){return this.primaryYaxisEntities.map(a=>this.Graph[a.index])}get secondaryYaxisSeries(){return this.secondaryYaxisEntities.map(a=>this.Graph[a.index])}intColor(a,b){const{color_thresholds:c,line_color:d}=this.config,e=+a||0;let f;if(0<c.length)if("bar"===this.config.show.graph){const{color:a}=c.find(a=>a.value<e)||c.slice(-1)[0];f=a}else{const b=c.findIndex(a=>a.value<e),d=c[b],g=c[b-1];if(g){const b=(g.value-a)/(g.value-d.value);f=xc(g.color,d.color,b)}else f=b?c[c.length-1].color:c[0].color}return this.config.entities[b].color||f||d[b]||d[0]}computeName(a){return this.config.entities[a].name||this.entity[a].attributes.friendly_name}computeIcon(a){return this.config.icon||a.attributes.icon||Fc[a.attributes.device_class]||Fc.temperature}computeUom(a){return this.config.entities[a].unit||this.config.unit||this.entity[a].attributes.unit_of_measurement||""}computeState(a){var b=Math.round;if(0<this.config.state_map.length){const b=Number.isInteger(a)?this.config.state_map[a]:this.config.state_map.find(b=>b.value===a);if(b)return b.label;console.warn("mini-graph-card: value [".concat(a,"] not found in state_map"))}let c="string"==typeof a?parseFloat(a.replace(/,/g,".")):+a;const d=this.config.decimals;if(d===void 0||va(d)||va(c))return b(100*c)/100;const e=10**d;return(b(c*e)/e).toFixed(d)}updateOnInterval(){this.stateChanged&&!this.updating&&(this.stateChanged=!1,this.updateData())}async updateData({config:a}=this){this.updating=!0;const b=this.getEndDate(),c=new Date(b);c.setHours(c.getHours()-a.hours_to_show);try{const a=this.entity.map((a,d)=>this.updateEntity(a,d,c,b));await Promise.all(a)}finally{this.updateQueue=[]}if(a.show.graph&&this.entity.forEach((a,b)=>{a&&this.Graph[b].update()}),this.updateBounds(),a.show.graph){let b=0;this.entity.forEach((c,d)=>{if(c&&0!==this.Graph[d].coords.length){const c="secondary"===a.entities[d].y_axis?this.boundSecondary:this.bound;if([this.Graph[d].min,this.Graph[d].max]=[c[0],c[1]],"bar"===a.show.graph)this.bar[d]=this.Graph[d].getBars(b,this.visibleEntities.length),b+=1;else{const b=this.Graph[d].getPath();!1!==a.entities[d].show_line&&(this.line[d]=b),a.show.fill&&!1!==a.entities[d].show_fill&&(this.fill[d]=this.Graph[d].getFill(b)),a.show.points&&!1!==a.entities[d].show_points&&(this.points[d]=this.Graph[d].getPoints()),0<a.color_thresholds.length&&!a.entities[d].color&&(this.gradient[d]=this.Graph[d].computeGradient(a.color_thresholds))}}}),this.line=L(this.line)}this.updating=!1,this.setNextUpdate()}updateBounds({config:a}=this){this.bound=[a.lower_bound===void 0?ya.apply(Math,L(this.primaryYaxisSeries.map(a=>a.min)))||this.bound[0]:a.lower_bound,a.upper_bound===void 0?xa.apply(Math,L(this.primaryYaxisSeries.map(a=>a.max)))||this.bound[1]:a.upper_bound],this.boundSecondary=[a.lower_bound_secondary===void 0?ya.apply(Math,L(this.secondaryYaxisSeries.map(a=>a.min)))||this.boundSecondary[0]:a.lower_bound_secondary,a.upper_bound_secondary===void 0?xa.apply(Math,L(this.secondaryYaxisSeries.map(a=>a.max)))||this.boundSecondary[1]:a.upper_bound_secondary]}async getCache(a,b){const c=await mc.getItem(a+(b?"":"-raw"));return c?b?zc(c):c:null}async setCache(a,b,c){return c?mc.setItem(a,yc(b)):mc.setItem("".concat(a,"-raw"),b)}async updateEntity(a,b,c,d){if(!a||!this.updateQueue.includes(a.entity_id)||!1===this.config.entities[b].show_graph)return;let e=[],f=c,g=!1;const h=this.config.cache?await this.getCache(a.entity_id,this.config.useCompress):void 0;if(h&&h.hours_to_show===this.config.hours_to_show){e=h.data;let a=e.findIndex(a=>new Date(a.last_changed)>c);-1===a?e=[]:(0<a&&(a-=1,e[a].last_changed=c),e=e.slice(a,e.length),g=!0);const b=new Date(h.last_fetched);b>f&&(f=new Date(b-1))}let i=await this.fetchRecent(a.entity_id,f,d,g);if(i[0]&&0<i[0].length&&(0<this.config.state_map.length&&i[0].forEach(a=>this._convertState(a)),i=i[0].filter(a=>!va(parseFloat(a.state))),i=i.map(a=>({last_changed:a.last_changed,state:a.state})),e=[].concat(L(e),L(i)),this.config.cache&&this.setCache(a.entity_id,{hours_to_show:this.config.hours_to_show,last_fetched:new Date,data:e},this.config.useCompress).catch(a=>{console.warn("mini-graph-card: Failed to cache: ",a),mc.clear()})),0!==e.length)if(a.entity_id===this.entity[0].entity_id&&(this.min=J({type:"min"},sc(e,"state")),this.avg={type:"avg",state:tc(e,"state")},this.max=J({type:"max"},uc(e,"state"))),!0===this.config.entities[b].fixed_value){const a=e[e.length-1];this.Graph[b].history=[a,a]}else this.Graph[b].history=e}async fetchRecent(a,b,c,d){let e="history/period";return b&&(e+="/".concat(b.toISOString())),e+="?filter_entity_id=".concat(a),c&&(e+="&end_time=".concat(c.toISOString())),d&&(e+="&skip_initial_state"),this._hass.callApi("GET",e)}_convertState(a){const b=this.config.state_map.findIndex(b=>b.value===a.state);-1===b||(a.state=b)}getEndDate(){const a=new Date;switch(this.config.group_by){case"date":a.setDate(a.getDate()+1),a.setHours(0,0,0);break;case"hour":a.setHours(a.getHours()+1),a.setMinutes(0,0);break;default:}return a}setNextUpdate(){if(!this.config.update_interval){const a=1/this.config.points_per_hour;clearInterval(this.interval),this.interval=setInterval(()=>{this.updating||this.updateData()},a*V)}}getCardSize(){return 3}}customElements.define("mini-graph-card",Nc)})})();
